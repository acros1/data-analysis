#filtered relationships but removing very low values
relationshipFilteredNoLowValues <- relationshipPerYearFiltered %>% filter(percent>1.5)
ggplot(data=relationshipFilteredNoLowValues, aes(x=Year, y=percent, fill=Relationship)) +
geom_bar(stat="identity")
relationshipPerYearCategories
#sort by categories
relationshipPerYearCategories = relationshipPerYear
for (i in 1:length(relationshipPerYearCategories)){
switch (relationshipPerYearCategories$Relationship[i],
"Acquaintance" = relationshipPerYearCategories$Category[i] = "acquaintance",
"Boyfriend" = relationshipPerYearCategories$Category[i] = "significant other",
"Boyfriend/Girlfriend" = relationshipPerYearCategories$Category[i] = "significant other",
"Brother" = relationshipPerYearCategories$Category[i] = "family",
"Common-Law Husband" = relationshipPerYearCategories$Category[i] = "significan other",
"Common-Law Wife" = relationshipPerYearCategories$Category[i] = "significan other",
"Daughter" = relationshipPerYearCategories$Category[i] = "family",
"Employee" = relationshipPerYearCategories$Category[i] = "professional",
"Employer" = relationshipPerYearCategories$Category[i] = "professional",
"Ex-Husband" = relationshipPerYearCategories$Category[i] = "ex significant other",
"Ex-Wife" = relationshipPerYearCategories$Category[i] = "ex significant other",
"Family" = relationshipPerYearCategories$Category[i] = "family",
"Father" = relationshipPerYearCategories$Category[i] = "family",
"Friend" = relationshipPerYearCategories$Category[i] = "acquaintance",
"Girlfriend" = relationshipPerYearCategories$Category[i] = "significant other",
"Husband" = relationshipPerYearCategories$Category[i] = "significant other",
"In-Law" = relationshipPerYearCategories$Category[i] = "indirect family",
"Mother" = relationshipPerYearCategories$Category[i] = "family",
"Neighbor" = relationshipPerYearCategories$Category[i] = "acquaintance",
"Sister" = relationshipPerYearCategories$Category[i] = "family",
"Son"= relationshipPerYearCategories$Category[i] = "family",
"Stepdaughter" = relationshipPerYearCategories$Category[i] = "indirect family",
"Stepfather" = relationshipPerYearCategories$Category[i] = "indirect family",
"Stepmother" = relationshipPerYearCategories$Category[i] = "indirect family",
"Stepson" = relationshipPerYearCategories$Category[i] = "indirect family",
"Stranger" = relationshipPerYearCategories$Category[i] = "stranger",
"Wife" = relationshipPerYearCategories$Category[i] = "significant other",
"Unknown" = relationshipPerYearCategories$Category[i] = "unknown"
)
}
for (i in 1:length(relationshipPerYearCategories)){
switch (relationshipPerYearCategories$Relationship[i],
"Acquaintance" = relationshipPerYearCategories$Category[i] <- "acquaintance",
"Boyfriend" = relationshipPerYearCategories$Category[i] <- "significant other",
"Boyfriend/Girlfriend" = relationshipPerYearCategories$Category[i] <- "significant other",
"Brother" = relationshipPerYearCategories$Category[i] <- "family",
"Common-Law Husband" = relationshipPerYearCategories$Category[i] <- "significan other",
"Common-Law Wife" = relationshipPerYearCategories$Category[i] <- "significan other",
"Daughter" = relationshipPerYearCategories$Category[i] <- "family",
"Employee" = relationshipPerYearCategories$Category[i] <- "professional",
"Employer" = relationshipPerYearCategories$Category[i] <- "professional",
"Ex-Husband" = relationshipPerYearCategories$Category[i] <- "ex significant other",
"Ex-Wife" = relationshipPerYearCategories$Category[i] <- "ex significant other",
"Family" = relationshipPerYearCategories$Category[i] <- "family",
"Father" = relationshipPerYearCategories$Category[i] <- "family",
"Friend" = relationshipPerYearCategories$Category[i] <- "acquaintance",
"Girlfriend" = relationshipPerYearCategories$Category[i] <- "significant other",
"Husband" = relationshipPerYearCategories$Category[i] <- "significant other",
"In-Law" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Mother" = relationshipPerYearCategories$Category[i] <- "family",
"Neighbor" = relationshipPerYearCategories$Category[i] <- "acquaintance",
"Sister" = relationshipPerYearCategories$Category[i] <- "family",
"Son"= relationshipPerYearCategories$Category[i] <- "family",
"Stepdaughter" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Stepfather" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Stepmother" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Stepson" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Stranger" = relationshipPerYearCategories$Category[i] <- "stranger",
"Wife" = relationshipPerYearCategories$Category[i] <- "significant other",
"Unknown" = relationshipPerYearCategories$Category[i] <- "unknown"
)
}
ggplot(data=relationshipPerYear, aes(x=Year, y=percent, fill=Relationship)) +
geom_bar(stat="identity")
relationshipPerYearCategoriesPercent <- relationshipPerYearCategories %>% group_by(Year, Category) %>% summarize(nb=n())
for (i in 1:nrow(relationshipPerYearCategoriesPercent)) {
relationshipPerYearCategoriesPercent$total[i] <- filter(homicidesPerYear, Year == relationshipPerYearCategoriesPercent$Year[i])$nb
}
relationshipPerYearCategoriesPercent$percent <- relationshipPerYearCategoriesPercent$nb / relationshipPerYearCategoriesPercent$total * 100
ggplot(data=relationshipPerYear, aes(x=Year, y=percent, fill=Categories)) +
geom_bar(stat="identity")
ggplot(data=relationshipPerYear, aes(x=Year, y=percent, fill=Category)) +
geom_bar(stat="identity")
#sort by categories
relationshipPerYearCategories = homicides
for (i in 1:length(relationshipPerYearCategories)){
switch (relationshipPerYearCategories$Relationship[i],
"Acquaintance" = relationshipPerYearCategories$Category[i] <- "acquaintance",
"Boyfriend" = relationshipPerYearCategories$Category[i] <- "significant other",
"Boyfriend/Girlfriend" = relationshipPerYearCategories$Category[i] <- "significant other",
"Brother" = relationshipPerYearCategories$Category[i] <- "family",
"Common-Law Husband" = relationshipPerYearCategories$Category[i] <- "significan other",
"Common-Law Wife" = relationshipPerYearCategories$Category[i] <- "significan other",
"Daughter" = relationshipPerYearCategories$Category[i] <- "family",
"Employee" = relationshipPerYearCategories$Category[i] <- "professional",
"Employer" = relationshipPerYearCategories$Category[i] <- "professional",
"Ex-Husband" = relationshipPerYearCategories$Category[i] <- "ex significant other",
"Ex-Wife" = relationshipPerYearCategories$Category[i] <- "ex significant other",
"Family" = relationshipPerYearCategories$Category[i] <- "family",
"Father" = relationshipPerYearCategories$Category[i] <- "family",
"Friend" = relationshipPerYearCategories$Category[i] <- "acquaintance",
"Girlfriend" = relationshipPerYearCategories$Category[i] <- "significant other",
"Husband" = relationshipPerYearCategories$Category[i] <- "significant other",
"In-Law" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Mother" = relationshipPerYearCategories$Category[i] <- "family",
"Neighbor" = relationshipPerYearCategories$Category[i] <- "acquaintance",
"Sister" = relationshipPerYearCategories$Category[i] <- "family",
"Son"= relationshipPerYearCategories$Category[i] <- "family",
"Stepdaughter" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Stepfather" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Stepmother" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Stepson" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Stranger" = relationshipPerYearCategories$Category[i] <- "stranger",
"Wife" = relationshipPerYearCategories$Category[i] <- "significant other",
"Unknown" = relationshipPerYearCategories$Category[i] <- "unknown"
)
}
relationshipPerYearCategoriesPercent <- relationshipPerYearCategories %>% group_by(Year, Category) %>% summarize(nb=n())
for (i in 1:nrow(relationshipPerYearCategoriesPercent)) {
relationshipPerYearCategoriesPercent$total[i] <- filter(homicidesPerYear, Year == relationshipPerYearCategoriesPercent$Year[i])$nb
}
relationshipPerYearCategoriesPercent$percent <- relationshipPerYearCategoriesPercent$nb / relationshipPerYearCategoriesPercent$total * 100
ggplot(data=relationshipPerYear, aes(x=Year, y=percent, fill=Category)) +
geom_bar(stat="identity")
o
ggplot(data=relationshipPerYearCategoriesPercent, aes(x=Year, y=percent, fill=Category)) +
geom_bar(stat="identity")
head(relationshipPerYearCategoriesPercent)
tail(relationshipPerYearCategoriesPercent)
head(relationshipPerYearCategories)
#sort by categories
relationshipPerYearCategories = homicides
for (i in 1:length(relationshipPerYearCategories)){
switch (relationshipPerYearCategories$Relationship[i],
"Acquaintance" = relationshipPerYearCategories$Category[i] <- "error",
"Boyfriend" = relationshipPerYearCategories$Category[i] <- "significant other",
"Boyfriend/Girlfriend" = relationshipPerYearCategories$Category[i] <- "significant other",
"Brother" = relationshipPerYearCategories$Category[i] <- "family",
"Common-Law Husband" = relationshipPerYearCategories$Category[i] <- "significan other",
"Common-Law Wife" = relationshipPerYearCategories$Category[i] <- "significan other",
"Daughter" = relationshipPerYearCategories$Category[i] <- "family",
"Employee" = relationshipPerYearCategories$Category[i] <- "professional",
"Employer" = relationshipPerYearCategories$Category[i] <- "professional",
"Ex-Husband" = relationshipPerYearCategories$Category[i] <- "ex significant other",
"Ex-Wife" = relationshipPerYearCategories$Category[i] <- "ex significant other",
"Family" = relationshipPerYearCategories$Category[i] <- "family",
"Father" = relationshipPerYearCategories$Category[i] <- "family",
"Friend" = relationshipPerYearCategories$Category[i] <- "acquaintance",
"Girlfriend" = relationshipPerYearCategories$Category[i] <- "significant other",
"Husband" = relationshipPerYearCategories$Category[i] <- "significant other",
"In-Law" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Mother" = relationshipPerYearCategories$Category[i] <- "family",
"Neighbor" = relationshipPerYearCategories$Category[i] <- "acquaintance",
"Sister" = relationshipPerYearCategories$Category[i] <- "family",
"Son"= relationshipPerYearCategories$Category[i] <- "family",
"Stepdaughter" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Stepfather" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Stepmother" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Stepson" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Stranger" = relationshipPerYearCategories$Category[i] <- "stranger",
"Wife" = relationshipPerYearCategories$Category[i] <- "significant other",
"Unknown" = relationshipPerYearCategories$Category[i] <- "unknown"
)
}
relationshipPerYearCategoriesPercent <- relationshipPerYearCategories %>% group_by(Year, Category) %>% summarize(nb=n())
for (i in 1:nrow(relationshipPerYearCategoriesPercent)) {
relationshipPerYearCategoriesPercent$total[i] <- filter(homicidesPerYear, Year == relationshipPerYearCategoriesPercent$Year[i])$nb
}
relationshipPerYearCategoriesPercent$percent <- relationshipPerYearCategoriesPercent$nb / relationshipPerYearCategoriesPercent$total * 100
ggplot(data=relationshipPerYearCategoriesPercent, aes(x=Year, y=percent, fill=Category)) +
geom_bar(stat="identity")
#sort by categories
relationshipPerYearCategories = homicides
for (i in 1:length(relationshipPerYearCategories)){
switch (relationshipPerYearCategories$Relationship[i],
"Boyfriend" = relationshipPerYearCategories$Category[i] <- "error",
"Acquaintance" = relationshipPerYearCategories$Category[i] <- "significant other",
"Boyfriend/Girlfriend" = relationshipPerYearCategories$Category[i] <- "significant other",
"Brother" = relationshipPerYearCategories$Category[i] <- "family",
"Common-Law Husband" = relationshipPerYearCategories$Category[i] <- "significan other",
"Common-Law Wife" = relationshipPerYearCategories$Category[i] <- "significan other",
"Daughter" = relationshipPerYearCategories$Category[i] <- "family",
"Employee" = relationshipPerYearCategories$Category[i] <- "professional",
"Employer" = relationshipPerYearCategories$Category[i] <- "professional",
"Ex-Husband" = relationshipPerYearCategories$Category[i] <- "ex significant other",
"Ex-Wife" = relationshipPerYearCategories$Category[i] <- "ex significant other",
"Family" = relationshipPerYearCategories$Category[i] <- "family",
"Father" = relationshipPerYearCategories$Category[i] <- "family",
"Friend" = relationshipPerYearCategories$Category[i] <- "acquaintance",
"Girlfriend" = relationshipPerYearCategories$Category[i] <- "significant other",
"Husband" = relationshipPerYearCategories$Category[i] <- "significant other",
"In-Law" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Mother" = relationshipPerYearCategories$Category[i] <- "family",
"Neighbor" = relationshipPerYearCategories$Category[i] <- "acquaintance",
"Sister" = relationshipPerYearCategories$Category[i] <- "family",
"Son"= relationshipPerYearCategories$Category[i] <- "family",
"Stepdaughter" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Stepfather" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Stepmother" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Stepson" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Stranger" = relationshipPerYearCategories$Category[i] <- "stranger",
"Wife" = relationshipPerYearCategories$Category[i] <- "significant other",
"Unknown" = relationshipPerYearCategories$Category[i] <- "unknown"
)
}
relationshipPerYearCategoriesPercent <- relationshipPerYearCategories %>% group_by(Year, Category) %>% summarize(nb=n())
for (i in 1:nrow(relationshipPerYearCategoriesPercent)) {
relationshipPerYearCategoriesPercent$total[i] <- filter(homicidesPerYear, Year == relationshipPerYearCategoriesPercent$Year[i])$nb
}
relationshipPerYearCategoriesPercent$percent <- relationshipPerYearCategoriesPercent$nb / relationshipPerYearCategoriesPercent$total * 100
ggplot(data=relationshipPerYearCategoriesPercent, aes(x=Year, y=percent, fill=Category)) +
geom_bar(stat="identity")
for (i in 1:length(relationshipPerYearCategories)){
switch (relationshipPerYearCategories$Relationship[i],
"Acquaintance" = (relationshipPerYearCategories$Category[i] <- "acquaintance"),
"Boyfriend" = relationshipPerYearCategories$Category[i] <- "significant other",
"Boyfriend/Girlfriend" = relationshipPerYearCategories$Category[i] <- "significant other",
"Brother" = relationshipPerYearCategories$Category[i] <- "family",
"Common-Law Husband" = relationshipPerYearCategories$Category[i] <- "significan other",
"Common-Law Wife" = relationshipPerYearCategories$Category[i] <- "significan other",
"Daughter" = relationshipPerYearCategories$Category[i] <- "family",
"Employee" = relationshipPerYearCategories$Category[i] <- "professional",
"Employer" = relationshipPerYearCategories$Category[i] <- "professional",
"Ex-Husband" = relationshipPerYearCategories$Category[i] <- "ex significant other",
"Ex-Wife" = relationshipPerYearCategories$Category[i] <- "ex significant other",
"Family" = relationshipPerYearCategories$Category[i] <- "family",
"Father" = relationshipPerYearCategories$Category[i] <- "family",
"Friend" = relationshipPerYearCategories$Category[i] <- "acquaintance",
"Girlfriend" = relationshipPerYearCategories$Category[i] <- "significant other",
"Husband" = relationshipPerYearCategories$Category[i] <- "significant other",
"In-Law" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Mother" = relationshipPerYearCategories$Category[i] <- "family",
"Neighbor" = relationshipPerYearCategories$Category[i] <- "acquaintance",
"Sister" = relationshipPerYearCategories$Category[i] <- "family",
"Son"= relationshipPerYearCategories$Category[i] <- "family",
"Stepdaughter" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Stepfather" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Stepmother" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Stepson" = relationshipPerYearCategories$Category[i] <- "indirect family",
"Stranger" = relationshipPerYearCategories$Category[i] <- "stranger",
"Wife" = relationshipPerYearCategories$Category[i] <- "significant other",
"Unknown" = relationshipPerYearCategories$Category[i] <- "unknown"
)
}
relationshipPerYearCategoriesPercent <- relationshipPerYearCategories %>% group_by(Year, Category) %>% summarize(nb=n())
for (i in 1:nrow(relationshipPerYearCategoriesPercent)) {
relationshipPerYearCategoriesPercent$total[i] <- filter(homicidesPerYear, Year == relationshipPerYearCategoriesPercent$Year[i])$nb
}
relationshipPerYearCategoriesPercent$percent <- relationshipPerYearCategoriesPercent$nb / relationshipPerYearCategoriesPercent$total * 100
ggplot(data=relationshipPerYearCategoriesPercent, aes(x=Year, y=percent, fill=Category)) +
geom_bar(stat="identity")
#sort by categories
relationshipPerYearCategories = homicides
for (i in 1:length(relationshipPerYearCategories)){
switch (relationshipPerYearCategories$Relationship[i],
"Acquaintance" = (relationshipPerYearCategories$Category[i] <- "acquaintance"),
"Boyfriend" = (relationshipPerYearCategories$Category[i] <- "significant other"),
"Boyfriend/Girlfriend" = (relationshipPerYearCategories$Category[i] <- "significant other"),
"Brother" = (relationshipPerYearCategories$Category[i] <- "family"),
"Common-Law Husband" = (relationshipPerYearCategories$Category[i] <- "significant other"),
"Common-Law Wife" = (relationshipPerYearCategories$Category[i] <- "significant other"),
"Daughter" = (relationshipPerYearCategories$Category[i] <- "family"),
"Employee" = (relationshipPerYearCategories$Category[i] <- "professional"),
"Employer" = (relationshipPerYearCategories$Category[i] <- "professional"),
"Ex-Husband" = (relationshipPerYearCategories$Category[i] <- "ex significant other"),
"Ex-Wife" = (relationshipPerYearCategories$Category[i] <- "ex significant other"),
"Family" = (relationshipPerYearCategories$Category[i] <- "family"),
"Father" = (relationshipPerYearCategories$Category[i] <- "family"),
"Friend" = (relationshipPerYearCategories$Category[i] <- "acquaintance"),
"Girlfriend" = (relationshipPerYearCategories$Category[i] <- "significant other"),
"Husband" = (relationshipPerYearCategories$Category[i] <- "significant other"),
"In-Law" = (relationshipPerYearCategories$Category[i] <- "indirect family"),
"Mother" = (relationshipPerYearCategories$Category[i] <- "family"),
"Neighbor" = (relationshipPerYearCategories$Category[i] <- "acquaintance"),
"Sister" = (relationshipPerYearCategories$Category[i] <- "family"),
"Son"= (relationshipPerYearCategories$Category[i] <- "family"),
"Stepdaughter" = (relationshipPerYearCategories$Category[i] <- "indirect family"),
"Stepfather" = (relationshipPerYearCategories$Category[i] <- "indirect family"),
"Stepmother" = (relationshipPerYearCategories$Category[i] <- "indirect family"),
"Stepson" = (relationshipPerYearCategories$Category[i] <- "indirect family"),
"Stranger" = (relationshipPerYearCategories$Category[i] <- "stranger"),
"Wife" = (relationshipPerYearCategories$Category[i] <- "significant other"),
"Unknown" = (relationshipPerYearCategories$Category[i] <- "unknown")
)
}
relationshipPerYearCategoriesPercent <- relationshipPerYearCategories %>% group_by(Year, Category) %>% summarize(nb=n())
for (i in 1:nrow(relationshipPerYearCategoriesPercent)) {
relationshipPerYearCategoriesPercent$total[i] <- filter(homicidesPerYear, Year == relationshipPerYearCategoriesPercent$Year[i])$nb
}
relationshipPerYearCategoriesPercent$percent <- relationshipPerYearCategoriesPercent$nb / relationshipPerYearCategoriesPercent$total * 100
ggplot(data=relationshipPerYearCategoriesPercent, aes(x=Year, y=percent, fill=Category)) +
geom_bar(stat="identity")
relationshipPerYearCategories$Relationship
relationshipPerYearCategories$Category
#sort by categories
relationshipPerYearCategories = homicides
for (i in 1:length(relationshipPerYearCategories)){
relationshipPerYearCategories$Category[i] = switch (relationshipPerYearCategories$Relationship[i],
"Acquaintance" =  "acquaintance",
"Boyfriend" =  "significant other",
"Boyfriend/Girlfriend" =  "significant other",
"Brother" =  "family",
"Common-Law Husband" =  "significan other",
"Common-Law Wife" =  "significan other",
"Daughter" =  "family",
"Employee" =  "professional",
"Employer" =  "professional",
"Ex-Husband" = "ex significant other",
"Ex-Wife" =  "ex significant other",
"Family" =  "family",
"Father" =  "family",
"Friend" =  "acquaintance",
"Girlfriend" =  "significant other",
"Husband" =  "significant other",
"In-Law" =  "indirect family",
"Mother" =  "family",
"Neighbor" =  "acquaintance",
"Sister" =  "family",
"Son"=  "family",
"Stepdaughter" = "indirect family",
"Stepfather" =  "indirect family",
"Stepmother" =  "indirect family",
"Stepson" =  "indirect family",
"Stranger" =  "stranger",
"Wife" =  "significant other",
"Unknown" =  "unknown"
)
}
relationshipPerYearCategoriesPercent <- relationshipPerYearCategories %>% group_by(Year, Category) %>% summarize(nb=n())
for (i in 1:nrow(relationshipPerYearCategoriesPercent)) {
relationshipPerYearCategoriesPercent$total[i] <- filter(homicidesPerYear, Year == relationshipPerYearCategoriesPercent$Year[i])$nb
}
relationshipPerYearCategoriesPercent$percent <- relationshipPerYearCategoriesPercent$nb / relationshipPerYearCategoriesPercent$total * 100
ggplot(data=relationshipPerYear, aes(x=Year, y=percent, fill=Category)) +
geom_bar(stat="identity")
ggplot(data=relationshipPerYearPercent, aes(x=Year, y=percent, fill=Category)) +
geom_bar(stat="identity")
#sort by categories
relationshipPerYearCategories = homicides
for (i in 1:length(relationshipPerYearCategories)){
relationshipPerYearCategories$Category[i] <- switch (relationshipPerYearCategories$Relationship[i],
"Acquaintance" =  "acquaintance",
"Boyfriend" =  "significant other",
"Boyfriend/Girlfriend" =  "significant other",
"Brother" =  "family",
"Common-Law Husband" =  "significan other",
"Common-Law Wife" =  "significan other",
"Daughter" =  "family",
"Employee" =  "professional",
"Employer" =  "professional",
"Ex-Husband" = "ex significant other",
"Ex-Wife" =  "ex significant other",
"Family" =  "family",
"Father" =  "family",
"Friend" =  "acquaintance",
"Girlfriend" =  "significant other",
"Husband" =  "significant other",
"In-Law" =  "indirect family",
"Mother" =  "family",
"Neighbor" =  "acquaintance",
"Sister" =  "family",
"Son"=  "family",
"Stepdaughter" = "indirect family",
"Stepfather" =  "indirect family",
"Stepmother" =  "indirect family",
"Stepson" =  "indirect family",
"Stranger" =  "stranger",
"Wife" =  "significant other",
"Unknown" =  "unknown"
)
}
relationshipPerYearCategoriesPercent <- relationshipPerYearCategories %>% group_by(Year, Category) %>% summarize(nb=n())
for (i in 1:nrow(relationshipPerYearCategoriesPercent)) {
relationshipPerYearCategoriesPercent$total[i] <- filter(homicidesPerYear, Year == relationshipPerYearCategoriesPercent$Year[i])$nb
}
relationshipPerYearCategoriesPercent$percent <- relationshipPerYearCategoriesPercent$nb / relationshipPerYearCategoriesPercent$total * 100
ggplot(data=relationshipPerYearPercent, aes(x=Year, y=percent, fill=Category)) +
geom_bar(stat="identity")
ggplot(data=relationshipPerYearCategoriesPercent, aes(x=Year, y=percent, fill=Category)) +
geom_bar(stat="identity")
relationshipPerYearCategories$Relationship[200]
relationshipPerYearCategories$Relationship[199]
#sort by categories
relationshipPerYearCategories = homicides
for (i in 1:nrow(relationshipPerYearCategories)){
relationshipPerYearCategories$Category[i] <- switch (relationshipPerYearCategories$Relationship[i],
"Acquaintance" =  "acquaintance",
"Boyfriend" =  "significant other",
"Boyfriend/Girlfriend" =  "significant other",
"Brother" =  "family",
"Common-Law Husband" =  "significan other",
"Common-Law Wife" =  "significan other",
"Daughter" =  "family",
"Employee" =  "professional",
"Employer" =  "professional",
"Ex-Husband" = "ex significant other",
"Ex-Wife" =  "ex significant other",
"Family" =  "family",
"Father" =  "family",
"Friend" =  "acquaintance",
"Girlfriend" =  "significant other",
"Husband" =  "significant other",
"In-Law" =  "indirect family",
"Mother" =  "family",
"Neighbor" =  "acquaintance",
"Sister" =  "family",
"Son"=  "family",
"Stepdaughter" = "indirect family",
"Stepfather" =  "indirect family",
"Stepmother" =  "indirect family",
"Stepson" =  "indirect family",
"Stranger" =  "stranger",
"Wife" =  "significant other",
"Unknown" =  "unknown"
)
}
relationshipPerYearCategoriesPercent <- relationshipPerYearCategories %>% group_by(Year, Category) %>% summarize(nb=n())
for (i in 1:nrow(relationshipPerYearCategoriesPercent)) {
relationshipPerYearCategoriesPercent$total[i] <- filter(homicidesPerYear, Year == relationshipPerYearCategoriesPercent$Year[i])$nb
}
relationshipPerYearCategoriesPercent$percent <- relationshipPerYearCategoriesPercent$nb / relationshipPerYearCategoriesPercent$total * 100
ggplot(data=relationshipPerYearCategoriesPercent, aes(x=Year, y=percent, fill=Category)) +
geom_bar(stat="identity")
#sort by categories
relationshipPerYearCategories = homicides
for (i in 1:nrow(relationshipPerYearCategories)){
relationshipPerYearCategories$Category[i] <- switch (relationshipPerYearCategories$Relationship[i],
"Acquaintance" =  "acquaintance",
"Boyfriend" =  "significant other",
"Boyfriend/Girlfriend" =  "significant other",
"Brother" =  "family",
"Common-Law Husband" =  "significan other",
"Common-Law Wife" =  "significan other",
"Daughter" =  "family",
"Employee" =  "professional",
"Employer" =  "professional",
"Ex-Husband" = "ex significant other",
"Ex-Wife" =  "ex significant other",
"Family" =  "family",
"Father" =  "family",
"Friend" =  "acquaintance",
"Girlfriend" =  "significant other",
"Husband" =  "significant other",
"In-Law" =  "indirect family",
"Mother" =  "family",
"Neighbor" =  "acquaintance",
"Sister" =  "family",
"Son"=  "family",
"Stepdaughter" = "indirect family",
"Stepfather" =  "indirect family",
"Stepmother" =  "indirect family",
"Stepson" =  "indirect family",
"Stranger" =  "stranger",
"Wife" =  "significant other",
"Unknown" =  "unknown"
)
}
relationshipPerYearCategoriesPercent <- relationshipPerYearCategories %>% group_by(Year, Category) %>% summarize(nb=n())
for (i in 1:nrow(relationshipPerYearCategoriesPercent)) {
relationshipPerYearCategoriesPercent$total[i] <- filter(homicidesPerYear, Year == relationshipPerYearCategoriesPercent$Year[i])$nb
}
relationshipPerYearCategoriesPercent$percent <- relationshipPerYearCategoriesPercent$nb / relationshipPerYearCategoriesPercent$total * 100
ggplot(data=relationshipPerYearCategoriesPercent, aes(x=Year, y=percent, fill=Category)) +
geom_bar(stat="identity")
library("ggplot2")
library("dplyr")
# Path to dataset is creating by this trick
scriptPath = paste(dirname(rstudioapi::getSourceEditorContext()$path), "/../dataset")
# And this trick to delete a parasite space
scriptPath = gsub ("src ", "src", scriptPath)
# Homicides
homicides = read.csv(file = file.path(scriptPath, "homicide-reports-1980_2014.csv"), sep = ",")
#sort by categories
relationshipPerYearCategories = homicides
for (i in 1:nrow(relationshipPerYearCategories)){
relationshipPerYearCategories$Category[i] <- switch (relationshipPerYearCategories$Relationship[i],
"Acquaintance" =  "acquaintance",
"Boyfriend" =  "significant other",
"Boyfriend/Girlfriend" =  "significant other",
"Brother" =  "family",
"Common-Law Husband" =  "significan other",
"Common-Law Wife" =  "significan other",
"Daughter" =  "family",
"Employee" =  "professional",
"Employer" =  "professional",
"Ex-Husband" = "ex significant other",
"Ex-Wife" =  "ex significant other",
"Family" =  "family",
"Father" =  "family",
"Friend" =  "acquaintance",
"Girlfriend" =  "significant other",
"Husband" =  "significant other",
"In-Law" =  "indirect family",
"Mother" =  "family",
"Neighbor" =  "acquaintance",
"Sister" =  "family",
"Son"=  "family",
"Stepdaughter" = "indirect family",
"Stepfather" =  "indirect family",
"Stepmother" =  "indirect family",
"Stepson" =  "indirect family",
"Stranger" =  "stranger",
"Wife" =  "significant other",
"Unknown" =  "unknown"
)
}
relationshipPerYearCategoriesPercent <- relationshipPerYearCategories %>% group_by(Year, Category) %>% summarize(nb=n())
for (i in 1:nrow(relationshipPerYearCategoriesPercent)) {
relationshipPerYearCategoriesPercent$total[i] <- filter(homicidesPerYear, Year == relationshipPerYearCategoriesPercent$Year[i])$nb
}
relationshipPerYearCategoriesPercent$percent <- relationshipPerYearCategoriesPercent$nb / relationshipPerYearCategoriesPercent$total * 100
ggplot(data=relationshipPerYearCategoriesPercent, aes(x=Year, y=percent, fill=Category)) +
geom_bar(stat="identity")
